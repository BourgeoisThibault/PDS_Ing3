{% extends "bootstrap/base.html" %}

{% block title %}Accueil{% endblock %}

{% block navbar %}
<div class="navbar navbar-fixed-top">
  <!-- ... -->
</div>
{% endblock %}

{% block content %}
<!--<h3>{{ request.method }}</h3>-->


      <div class="container starter-template">
        <h1>Bienvenue</h1>
        <p class="lead">ESIBANK</p>
      </div>

    <div class="container main-content-verif">
            <h1>Vérification en cours...</h1>
    </div>

    <div class="container main-content-err">
        <div class="starter-template">
            <div class="alert alert-warning">
                <strong>Erreur contact NFC - Merci de ré-essayer</strong>
            </div>
        </div>

    </div>
<div class="loading"></div>

{% endblock %}
{% block scripts %}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<script type="text/javascript" charset="utf-8">
    var socket = io.connect('http://' +  document.domain + ':' + location.port + '/test');
     //var numbers_received = [];
     var numbers_received = '';


     //receive details from server
    socket.on('newnumber', function(msg) {
        console.log("Received number" + msg.number);
        var response =msg.number;
        if(msg.number==1){
            // $(".loading").css('visibility', 'visible');
            // $(".main-content-verif").css('visibility', 'visible');
            // setTimeout(function(){
            //     console.log("waiting....");
            // }, 2000);
            window.location.href = '/pinui';
        }else if(msg.number==2){
            console.log("Reponse 2");

            $(".main-content-verif").css('visibility','visible');
            $(".loading").addClass("modal");
            $(".loading").css('visibility', 'visible');

            setTimeout(function(){
                console.log("waiting....");
            }, 2000);

            $(".main-content-err").css('visibility', 'visible');
            setTimeout(function(){
                console.log("waiting err...");
            }, 2000);

            // $(".main-content-err").css('visibility', 'hidden');


        }


        $(".main-content-verif").css('visibility','hidden');
        $(".loading").removeClass("modal");
        $(".loading").css('visibility', 'hidden');


    });

</script>
    <!--</body>-->

<!--</html>-->
{% endblock %}


{% block styles %}
{{super()}}
<link rel="stylesheet"
      href="{{url_for('.static', filename='css/pinui.css')}}">
{% endblock %}